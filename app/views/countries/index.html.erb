<% content_for :head do %>
	<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
	<script type="text/javascript">
	$(document).ready(function(){

		var latlng = new google.maps.LatLng(-0, 0);
		var myOptions = {
			zoom: 2,
			center: latlng,
			mapTypeId: google.maps.MapTypeId.ROADMAP
		};
		
		var map = new google.maps.Map(document.getElementById("advice_map"),myOptions);

		<% @outlines.each do |outline| %>
			var coords = []

			<% outline.polygons.each do |pg| %>
				var c = [<%= pg.map{|p| "new google.maps.LatLng(#{p.last.to_f}, #{p.first.to_f})"}.join(', ') %>];
				coords.push(c)
    	<% end %>

		poly = new google.maps.Polygon({
			paths: coords,
			strokeColor: "#FF0000",
			strokeOpacity: 0.8,
			strokeWeight: 2,
			fillColor: "#FF0000",
			fillOpacity: 0.35
		});
		
    google.maps.event.addListener(poly, 'click', function() {
      console.log("you clicked <%=  outline.country.name %>");
    });
    
		
		poly.setMap(map);

		<% end %>

	});

	</script>
<% end %>


<h1>Countries with a current Foreign Office Warning</h1>


<div id="advice_map"></div>

<div id="countries">
  <ul>
  <% @countries.each do |country| %>
  	<li><%= country.name %> - <%= country.travel_advice %></li>
  <% end %>
  </ul>
  
</div>

